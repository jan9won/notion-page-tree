# Notion Page Tree
> Fetch nested Notion pages from the root page/database/block.

---

- [Notion Page Tree](#notion-page-tree)
	- [Why Would I Want This?](#why-would-i-want-this)
		- [ğŸ™Œ Use the official Notion API.](#-use-the-official-notion-api)
		- [ğŸ•¸ Fetch nested children pages.](#-fetch-nested-children-pages)
		- [ğŸ›  Handle API Errors gracefully.](#-handle-api-errors-gracefully)
	- [Other Features](#other-features)
		- [ğŸ’¾ It saves fetch results to your local disk.](#-it-saves-fetch-results-to-your-local-disk)
		- [ğŸ¥ It builds basic page server.](#-it-builds-basic-page-server)
		- [ğŸ” It builds basic page search indexes.](#-it-builds-basic-page-search-indexes)
	- [Usage](#usage)
		- [`.env` File Configuration](#env-file-configuration)
		- [Create Instance](#create-instance)
		- [Fetcher and Server Setup (sample)](#fetcher-and-server-setup-sample)
	- [How It Works (Flowchart)](#how-it-works-flowchart)

---

## Why Would I Want This?
### ğŸ™Œ Use the official Notion API.
- Popular `/loadpagechunk/` endpoint is not public and may not be stable in future updates.
- Official API can be integrated with private key, so you can keep your database private.

### ğŸ•¸ Fetch nested children pages.
- Pages inside non-page blocks are also fetched.
- Max search-depth can be set in your preference.

### ğŸ›  Handle API Errors gracefully.
- Maximum fetch concurrency is set to avoid `rate_limited` error.
- On `rate_limited` error, it stops and waits for some minutes.
- Other errors are automatically retried. Max retry count can be set in your preference.

---

## Other Features
### ğŸ’¾ It saves fetch results to your local disk.
- Set parameter `private_file_path` to your custom path.

### ğŸ¥ It builds basic page server.
- `/page/:id/` endpoint for retrieving page and its childrens' id.
- `/tree/:id/` endpoint for retrieving all nested pages from the page.
  
### ğŸ” It builds basic page search indexes.
- Uses lunr.js.
- Page's properties and chilren are converted into plain text for building search index.
- `/search?keyword=` endpoint for searching page properties and retrieving page ids.
- `/suggestion?keyword=` endpoint for looking for search index's tokens.

---

## Usage
### `.env` File Configuration

Write directly on `<package_root>/.env`
```text
NOTION_ENTRY_ID = <root page/database/block's id>
NOTION_ENTRY_KEY = <root's integration key>
NOTION_ENTRY_TYPE = <page/database/block>
```

### Create Instance
Interactively Ask for parameters.
```js
const notionPageTree = new NotionPageTree({
	fetchIntervalMinutes: 5,
	private_file_path: path.resolve('./sample/')
});
```

### Fetcher and Server Setup (sample)
  
Run `yarn serve` to see fetcher running in action.

Sample database is here https://notion.so/2345a2ce3cdd48f183cca1f6d1ae25ca

`./sample/index.ts`
```js
import NotionPageTree from 'notion-page-tree';
import path from 'path';

(async function main() {
	// Create main class instance.
	const notionPageTree = new NotionPageTree({
		private_file_path: path.resolve('./sample/'),
		createFetchQueueOptions: {
			maxConcurrency: 3, // Current official rate limit is 3 requests per second. Notion api will throw error when you increase this value.
			maxRetry: 2, // "rate_limited" error will not be retried and process will be exited immediately.
			maxRequestDepth: 3, // Depth applied to all the entities.
			maxBlockDepth: 2, // Depth applied to blocks (relative to nearest parent page).
			databaseQueryFilter: {
				// Database query filter.
				property: 'isPublished',
				checkbox: {
					equals: true
				}
			}
		}
	});

	notionPageTree.parseCachedDocument();
	// Look for cached documents in `private_file_path`, assign to Page Data Variables.

	const requestParameters = await notionPageTree.setRequestParameters({
		forceRewrite: false,
		prompt: true
	});
	console.log(
		'Requesting',
		requestParameters.entry_type,
		'with id',
		requestParameters.entry_id
	);
	// Set environment variables that are needed for Notion API.

	const server = notionPageTree.setupServer({ port: 8888 });
	// Setup servers for listing and searching pages. (will respond 503 if pages are undefined)

	// await notionPageTree.fetchOnce();
	// Fetch pages asynchronously, then assign results to variables.

	notionPageTree.startFetchLoop(1000 * 10); // 10 seconds
	// Create asynchronouse fetch loop, which waits for some milliseconds between each fetch.

	setTimeout(() => {
		// after 30 seconds
		console.log('stopping fetch loop');
		notionPageTree.stopFetchLoop();
		// Stopping fetch loop after current fetch resolves.
		console.log('closing servers');
		server.close();
		// Stopping servers immediately.
	}, 1000 * 30);
})();

```

## How It Works (Flowchart)
<div style="overflow-x: scroll !important; white-space: pre-wrap !important;">
<pre style="display: inline-block;">
<code>/******************************************************************************************************************************************************************************************************************************************************************************************************************************\
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
*    â”â”â”â”â”â”â”â”Main Routineâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                                                                                                                                                *
*    â”ƒ                                                                                                                                                                        â”ƒ                                                                                                                                                *
*    â”ƒ                                                                                                                                                                        â”ƒ                                                                                                                                                *
*    â”ƒ                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”Œâ”€â”€â”€â–¶â”‚    page_collection    â”‚                                        â”ŒclearTimeout()â”€â”€â”€â–¶â”‚ Request Promise Timer â”‚                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚                                                  Î›                  â”‚                                                            â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â•± â•²                 â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”œâ”€â”€â”€â–¶â”‚       page_tree       â”‚                   â•±   â•²                â”œclearTimeout()â”€â”€â”€â–¶â”‚  Request Ready Timer  â”‚                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â•±     â•²               â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚                                              â•±       â•²              â”‚                                                            â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â•±  check  â•²             â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”ƒ                                                                                                                                                *
*    â”ƒ                                     â”œâ”€â”€â”€â–¶â”‚ Request Promise Queue â”‚â”€â”€â”€â”€â”€â”€â”        â•±  routine  â•²            â”‚   â”Œâ”€â”€â”€update â”€â”€â”€â–¶â”‚ page_collection â”‚                       â”ƒ                                                                                                                                                *
*    â”ƒ        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚       â•±      â†»      â•²           â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”ƒ                                                                                                                                                *
*    â”ƒ        â”‚    Fetcher Routine    â”‚â”€â”€â”€â”€â”¤                                   â”œâ”€â”€â”€â”€â”€â–¶â–•  promise = 0  â–â”€â”€â”¬â”€trueâ”€â”€â”¼â”€â”€â”€â”¤                                                        â”ƒ                                                                                                                                                *
*    â”ƒ        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚       â•²  ready = 0  â•±   â”‚       â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”ƒ                                                                                                                                                *
*    â”ƒ                    â–²                â”œâ”€â”€â”€â–¶â”‚  Request Ready Queue  â”‚â”€â”€â”€â”€â”€â”€â”˜        â•²     â†»     â•±    â”‚       â”‚   â””â”€â”€â”€updateâ”€â”€â”€â”€â–¶â”‚    page_tree    â”‚                       â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â•²   0ms   â•±     â”‚       â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚                                              â•²       â•±      â”‚       â”‚                                                            â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â•²     â•±       â”‚       â”‚                                                            â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”œâ”€â”€â”€â–¶â”‚ Request Promise Timer â”‚                   â•²   â•±        â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ wait for some minutes â”€ â”€ â”             â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â•² â•±         â”‚                                                                    â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚                                                  V          â”‚                                                      â”‚             â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â–²          â”‚                                                                    â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                â””â”€â”€â”€â–¶â”‚  Request Ready Timer  â”‚                     â””â”€â”€falseâ”€â”€â”€â”˜                                                      â”‚             â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                     â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚                                                                                                                                     â”‚             â”ƒ                                                                                                                                                *
*    â”ƒ                    â”‚â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€  create new fetcher routine â—€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€              â”ƒ                                                                                                                                                *
*    â”ƒ                                                                                                                                                                        â”ƒ                                                                                                                                                *
*    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                                                                                                                                                *
*                                                                                                                                                                                                                                                                                                                              *
*                         â”‚                                                                                                                                                                                                                                                                                                    *
*                                                                                                                                                                                                                                                                                                                              *
*                         â”‚                                                                                                                                                                                                                                                                                                    *
*                                                                                                                                                                                                                                                                                                                              *
*     â”â”â”â”Fetcher Routineâ”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“    *
*     â”ƒ                                                                                                                                                                                                  â”Œâ”€.plaintext += plaintextâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”ƒ    *
*     â”ƒ                                                                                                                                                                                                  â”‚                                                                            â”‚                                   â”ƒ    *
*     â”ƒ                                                                                                                                                                     â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚                                      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—              â”‚                                   â”ƒ    *
*     â”ƒ                                                                                                                       â”Œâ”€â”€falseâ”€â”€â”€â”                                  â•‘  Promise (resolved)      â•‘ â”œâ”€.children.push()â”                    â•‘Connector             â•‘              â”‚                                   â”ƒ    *
*     â”ƒ                                                                                    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚          â”‚                                  â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘ â”‚                 â”‚                    â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘              â”‚                                   â”ƒ    *
*     â”ƒ                                                                                    â”ƒ   Request Promise Queue        â”ƒ â”‚          â”‚                                  â•‘â”‚parentToAssign: Entity â”‚â—€â”€â”€â”˜       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘ â”‚toAssigned: itselfâ”‚ â•‘              â”‚                                   â”ƒ    *
*     â”ƒ                                                                                    â”ƒ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”ƒ â”‚          Î›                                  â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”Œâ”€â”€â”€â”€â–¶â”‚ is Page/Database â”‚â”€â”€createâ”€â”€â–¶â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”ƒ    *
*     â”ƒ                                                                                    â”ƒ â•‘  Promise (pending)       â•‘   â”ƒ â”‚         â•± â•²                                 â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘              â”‚                 â”‚                 â”ƒ    *
*     â”ƒ       â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                                          â”ƒ â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒ â”‚        â•±   â•²                                â•‘â”‚parentToRequest: Entityâ”‚ â•‘   â”‚                      â”‚             â•‘â”‚toRequested: itself â”‚â•‘              â”‚                 â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ  New Requests                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¬â–¶â”‚parentToAssign: Entity â”‚â•‘   â”ƒ â”‚       â•±     â•²            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚                      â”‚             â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘              â”‚                 â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚ â”ƒ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”ƒ â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘...â”ƒ â”‚      â•±       â•²       â”Œâ”€â”€â–¶â”‚ is Fulfilled â”‚â”€â”€â–¶â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚                      â”‚             â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â”‚                 â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”‚ â”ƒ â”‚                                      â”‚ â”ƒ â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒ â”‚     â•±  set    â•²      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘â”‚       children:       â”‚ â•‘   â”‚                      â”‚                                                   â”‚                 â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”‚parentToAssign: Entity â”‚â• â”€â”€â”€â”˜ â”ƒ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    List Block      â””â”€â•‹â”€â•¬â–¶â”‚parentToRequest: Entityâ”‚â•‘   â”ƒ â”‚    â•± interval  â•²     â”‚                      â•‘â”‚   QueryablePromise    â”‚â”€â•¬â”€â”€â”€â”¤                      â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘     â”ƒ â”œâ”€â”€â–¶â”‚is Block/Pageâ”‚â”€â”€â”€â–¶Children()â”€â”€â”€â”€â”€â”  â”ƒ â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ â”‚   â•±      â†»      â•²    â”‚                      â•‘â”‚       Entity[]        â”‚ â•‘   â”‚                      â”‚       extractPlainText                  â”‚   Concatenated   â”‚        â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘ ... â”ƒ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”ƒ â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒâ”€â”´â”€â–¶â–•  promise > 0  â–â”€â”€â”€â”¤                      â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚                      â”‚    â”Œâ”€â–¶   FromBlock    â”€â”€â”€â”€â–¶.reduce()â”€â”€â”€â–¶â”‚    Plain Text    â”‚        â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”‚parentToRequest: Entityâ”‚â• â”€â”€â”€â”€â”€â”€â”€â”˜                                 .push()â”ƒ â•‘ â”‚       children:       â”‚â•‘   â”ƒ     â•² isSetteled  â•±    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚                      â”‚    â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘     â”ƒ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      Query        â”Œâ”€â”€â”€â”€â•¬â–¶â”‚   QueryablePromise    â”‚â•‘   â”ƒ      â•²     â†»     â•±     â””â”€â”€â–¶â”‚ is Rejected  â”‚   â•‘â”‚     retry: number     â”‚ â•‘   â”‚                      â”‚    â”‚                                                                â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘     â”ƒ â””â”€â”€â–¶â”‚ is Database â”‚â”€â”€â”€â–¶Database()â”€â”€â”€â”€â”€â”˜  â”ƒ â•‘ â”‚       Entity[]        â”‚â•‘   â”ƒ       â•²   0ms   â•±          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”  â”‚                                                                â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â”‚     retry: number     â”‚â•‘     â”ƒ     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”ƒ â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ        â•²       â•±                    â”‚         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â””â”€â”€â”€â”€â–¶â”‚     is Block   â”‚ â”‚â”€â”€â”¤                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘     â”ƒ                                          â”ƒ â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒ         â•²     â•±                     â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”˜  â”‚                     â”‚  is in Traverse  â”‚                       â”‚                 â”ƒ    *
*     â”ƒ       â”ƒ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”ƒ                                          â”ƒ â•‘ â”‚     retry: number     â”‚â•‘   â”ƒ          â•²   â•±                      â”‚               set maxConcurrency to 0                         â”‚    â”‚               â”Œâ”€â”€â”€â”€â–¶â”‚  Exclusion List  â”‚           â•”â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•—      â”ƒ    *
*     â”ƒ       â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â–²â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                                          â”ƒ â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ           â•² â•±                       â–¼               empty promise_queue                             â”‚    â”‚               â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘Connector  â”‚          â•‘      â”ƒ    *
*     â”ƒ                      â”‚                                                             â”ƒ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”ƒ            V                  rate_limitedâ”€â”€trueâ”€â”€â–¶ move promises to ready_queue                    â”‚    â””â”€â–¶.filter()â”€â”€â”€â”€â”¤     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘      â”ƒ    *
*     â”ƒ                      â”‚                                                             â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                                     â”‚               wait for some minutes                           â”‚                    â”‚     â”‚is NOT in Traverseâ”‚           â•‘ â”‚toAssigned: PARENTâ”‚ â•‘      â”ƒ    *
*     â”ƒ                      â”‚                                                                                                                                    â”‚               set maxConcurrency to 3                         â”‚                    â””â”€â”€â”€â”€â–¶â”‚  Exclusion List  â”‚â”€â”€createâ”€â”€â–¶â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘      â”ƒ    *
*     â”ƒ                      â”‚                                                                                      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                 false                                                             â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘      â”ƒ    *
*     â”ƒ                      â”‚                                                                                      â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                   â”‚                                                               â”‚                                                         â•‘â”‚toRequested: itself â”‚â•‘      â”ƒ    *
*     â”ƒ            .splice(concurrency -                                                                            â•‘â”‚parentToAssign: Entity â”‚â•‘                   â”‚                                                               â”‚                                                         â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘      â”ƒ    *
*     â”ƒ               promise.length)                                                                               â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                   â–¼                                                               â”‚                                                         â•šâ•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•      â”ƒ    *
*     â”ƒ                      â”‚                                                                                      â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘               retry <                                                             â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                                                                               â”Œâ”€â”€â”€â”€â”€â”€â•‘â”‚parentToRequest: Entityâ”‚â•‘â—€â”€â”€â”€trueâ”€â”€â”€â”€â”€ retryCount â”€â”€falseâ”€â”€â–¶ console.error                                  â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                                                                               â”‚      â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                   â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                                                                               â”‚      â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                   â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                         â”Œâ”€â”€falseâ”€â”€â”€â”                                          â”‚      â•‘â”‚      retry: +=1       â”‚â•‘                                                                                   â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                         â”‚          â”‚                                          â”‚      â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                   â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                         â”‚          â”‚                                     .unshift()  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                   â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                         Î›          â”‚                                          â–¼                                                                                                                    â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                        â•± â•²         â”‚            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                       â•±   â•²        â”‚            â”ƒ  Request Ready Queue                                      â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                      â•±     â•²       â”‚            â”ƒ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                     â•±       â•²      â”‚            â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                    â•±  check  â•²     â”‚            â”ƒ â•‘â”‚parentToAssign: Entity â”‚â•‘ â•‘â”‚parentToAssign: Entity â”‚â•‘   â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                   â•±  routine  â•²    â”‚            â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â”‚                  â•±      â†»      â•²   â”‚            â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘...â”ƒ                                                                                      â”‚                                                                     â”‚                 â”ƒ    *
*     â”ƒ                      â””â”€â”€â”€â”€â”€â”€trueâ”€â”€â”€â”€â”€â”€â”€â–•  ready > 0    â–â—€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”ƒ â•‘â”‚parentToRequest: Entityâ”‚â•‘ â•‘â”‚parentToRequest: Entityâ”‚â•‘   â”ƒâ—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€.push()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”ƒ    *
*     â”ƒ                                         â•² promise < 3 â•±                â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                          â•²           â•±                 â”ƒ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘ â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘   â”ƒ                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                           â•²    â†»    â•±                  â”ƒ â•‘â”‚       retry: 0        â”‚â•‘ â•‘â”‚       retry: 0        â”‚â•‘   â”ƒ                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                            â•² 250ms â•±                   â”ƒ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘ â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘   â”ƒ                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                             â•²     â•±                    â”ƒ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”ƒ                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                              â•²   â•±                     â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                                                                                      â”‚                                                                                       â”ƒ    *
*     â”ƒ                                               â•² â•±                                                    â–²                                                                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                V                                                     â”‚                    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                                   (init)                  â”ƒ  Page Collection         â”ƒ                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”ƒ â”Œâ”€â”€â”€â”€â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”ƒ                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”ƒ â”‚ id â•‘  page: Entity   â•‘ â”ƒ                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”ƒ â””â”€â”€â”€â”€â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”ƒ                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”ƒ â”Œâ”€â”€â”€â”€â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”ƒ                                                                    â”‚                                                                                       â”ƒ    *
*     â”ƒ                                                                                            â”‚       ROOT       â”‚â”€â”€â”€(init)â”€â–¶â”ƒ â”‚ id â•‘  page: Entity   â•‘ â”ƒâ—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€assign with keyâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                       â”ƒ    *
*     â”ƒ                                                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”ƒ â””â”€â”€â”€â”€â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”ƒ                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”ƒ â”Œâ”€â”€â”€â”€â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”ƒ                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                                           â”ƒ â”‚ id â•‘  page: Entity   â•‘ â”ƒ                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”ƒ â””â”€â”€â”€â”€â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”ƒ                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                                           â”ƒ           ....           â”ƒ                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                      â”‚                    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                                                         â”‚                                                                                                                                                                         â”ƒ    *
*     â”ƒ                                                                                                      â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”¬ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€                                                                                                                                                                          â”ƒ    *
*     â”ƒ                                                                                                                                                                                                                                                                                                                   â”ƒ    *
*     â”ƒ                                                                                                                      â”‚                                                                                                                                                                                            â”ƒ    *
*     â”ƒ                                                                                                          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘ Entity               â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚     id: string     â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚   depth: number    â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚       type:        â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚ 'page'|'database'| â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚      'block'       â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚     metadata:      â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚GetBlockResponseWithâ”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚      Metadata      â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚     plainText:     â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚extractPlainText(...â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚     children)      â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â”‚ children: Entity[] â”‚â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                                                                                                                 â”ƒ    *
*     â”ƒ                                                                                                                                                                                                                                                                                                                   â”ƒ    *
*     â”ƒ                                                                                                                                                                                                                                                                                                                   â”ƒ    *
*     â”ƒ                                                                                                                                                                                                                                                                                                                   â”ƒ    *
*     â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›    *
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
*                                                                                                                                                                                                                                                                                                                              *
\******************************************************************************************************************************************************************************************************************************************************************************************************************************/</code></pre>
</div>